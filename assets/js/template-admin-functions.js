window._Template={appUrl:"http://app.hotsitestore.com.br",siteUrl:"http://www.hotsitestore.com.br",isEditing:!1,templateId:"",init:function(){_Template.sendForm();_Template.setDomainType();_Template.buttonDuplicator();_Template.nextFormSection();_Template.validateDomainField();_Template.validateUrl();_Template.validationTranslate();_Template.loadDemoContent();_Template.loadTplConfig()},setDomainType:function(){$('select[name="domainType"]').change(function(){var a=($(this).val()||"").trim();a.length&&
($(".domain-type").stop().slideUp(),$("."+a+"-domain-wrapper").removeClass("hide").hide().stop().slideDown())})},sendForm:function(){$("form").validate({submitHandler:function(a){a=$(a);if(a.valid())return _Template.sendData(a),!1}})},validateDomainField:function(){$('.subdomain-domain-wrapper [name="domain"]').on("keyup focusout",function(){var a=$(this);a.val(_Template.sanitizeString(a.val()||"").replace(/\.+/g,""))});$('.custom-domain-wrapper [name="domain"]').on("keyup focusout",function(){var a=
$(this);a.val(_Template.sanitizeString(a.val()||""))})},validateUrl:function(){$('[type="url"]').on("focusout",function(){var a=$(this),c=$("<a>")[0],b=a.val()||"";b.length&&(0>b.indexOf("http")&&(b="//"+b.replace(/^\/+/,"")),c.href=b,a.val(c.href))})},sanitizeString:function(a){return a.replace(/[\u00e1\u00e0\u00e3\u00e2\u00e4]/gi,"a").replace(/[\u00e9\u00e8\u00ea\u00eb]/gi,"e").replace(/[\u00ed\u00ec\u00ee\u00ef]/gi,"i").replace(/[\u00f3\u00f2\u00f5\u00f4\u00f6]/gi,"o").replace(/[\u00fa\u00f9\u00fb\u00fc]/gi,
"u").replace(/[\u00e7]/gi,"c").replace(/[\u00f1]/gi,"n").replace(/[^a-z0-9\-\.]/gi,"")},buttonDuplicator:function(a){a=a||$(".duplicate-option");a.click(function(a){a.preventDefault();a=$(this);if(a.is(".remove-option"))$(this).closest("fieldset").slideUp(function(){$(this).remove()});else{var b=$(this).closest("fieldset"),b=b.clone().hide().insertAfter(b).slideDown().find(".duplicate-option");_Template.buttonDuplicator(b);a.removeClass("duplicate-option").addClass("remove-option").find("i").text("remove")}})},
nextFormSection:function(){var a=$(".card"),c=$(".main-panel");a.each(function(b){$(this).find(".pager .withripple").click(function(){$(document.body).attr("data-step",$(this).is(".next")?b+1:b);var e=a.filter(":eq("+($(this).is(".next")?b+1:b-1)+")");e.length&&c.animate({scrollTop:c.scrollTop()+e.offset().top-30})})})},validationTranslate:function(){jQuery.extend(jQuery.validator.messages,{required:"Este campo &eacute; obrigat\u00f3rio.",remote:"Por favor, corrija este campo.",email:"Por favor, forne&ccedil;a um endere&ccedil;o eletr&ocirc;nico v&aacute;lido.",
url:"Por favor, forne&ccedil;a uma URL v&aacute;lida.",date:"Por favor, forne&ccedil;a uma data v&aacute;lida.",dateISO:"Por favor, forne&ccedil;a uma data v&aacute;lida (ISO).",number:"Por favor, forne&ccedil;a um n&uacute;mero v&aacute;lido.",digits:"Por favor, forne&ccedil;a somente d&iacute;gitos.",creditcard:"Por favor, forne&ccedil;a um cart&atilde;o de cr&eacute;dito v&aacute;lido.",equalTo:"Por favor, forne&ccedil;a o mesmo valor novamente.",accept:"Por favor, forne&ccedil;a um valor com uma extens&atilde;o v&aacute;lida.",
maxlength:jQuery.validator.format("Por favor, forne&ccedil;a n&atilde;o mais que {0} caracteres."),minlength:jQuery.validator.format("Por favor, forne&ccedil;a ao menos {0} caracteres."),rangelength:jQuery.validator.format("Por favor, forne&ccedil;a um valor entre {0} e {1} caracteres de comprimento."),range:jQuery.validator.format("Por favor, forne&ccedil;a um valor entre {0} e {1}."),max:jQuery.validator.format("Por favor, forne&ccedil;a um valor menor ou igual a {0}."),min:jQuery.validator.format("Por favor, forne&ccedil;a um valor maior ou igual a {0}.")})},
loadDemoContent:function(){$(".load-demo-content").click(function(a){a.preventDefault();if(!hsDemoContent)return alert("Este tema n\u00e3o possui conte\u00fado de demo.");_Template.loadContentSetFieldValue($(this).closest(".card"),hsDemoContent)})},loadContentSetFieldValue:function(a,c){var b;for(b in c)if("object"==typeof c[b]){var e=a.find('[data-hs-name="'+b+'"]');if(e.length)for(var d=0;d<c[b].length;d++)_Template.loadContentSetFieldValue(e.filter(":eq("+d+")"),c[b][d])}else a.find('[data-hs-name="'+
b+'"]').val(c[b]).change()},loadTplConfig:function(){var a=(location.search.match(/id=([^?]+)/i)||[""]).pop().trim();if(!a.length)return a;$('[data-hs-name="domainType"], [data-hs-name="domain"]').attr("disabled","disabled");$.ajax({url:_Common.appUrl+"/api-v1/user/my/template/"+a,headers:{"x-hs-session-token":Cookies.get("hs-session")},dataType:"json"}).done(function(c){$(".card").each(function(){var a=$(this);a.find("[data-hs-name]").length&&_Template.loadContentSetFieldValue(a,c)});_Template.isEditing=
!0;_Template.templateId=a}).fail(_Common.ajaxAuthErrorMsg)},sendData:function(a){_Template.tplConfig={};_Template.addToHierarchy(_Template.tplConfig,a);var c={account:Cookies.get("hs-account"),domainType:_Template.tplConfig.domainType,template:hsThemeConfig.name,domain:_Template.tplConfig.domain,tplConfig:_Template.tplConfig,tplCodename:hsThemeConfig.codename},c={url:_Template.appUrl+"/api-v1/template/"+(_Template.isEditing?_Template.templateId:""),type:_Template.isEditing?"PUT":"POST",contentType:"application/json",
dataType:"json",data:JSON.stringify(c)};_Template.isEditing&&(c.headers={"x-hs-session-token":Cookies.get("hs-session")});var b=a.find('[type="submit"]').attr("disabled","disabled");$.ajax(c).done(function(){$(".message-wrapper").html('<div class="alert alert-success"> <span><b> Parab\u00e9ns! </b> Seu HotSite foi criado com sucesso :)</span> </div>')}).fail(function(a){a.responseJSON?$(".message-wrapper").html('<div class="alert alert-danger"> <span><b> Erro - </b> '+a.responseJSON.error+"</span> </div>"):
$(".message-wrapper").html('<div class="alert alert-danger"> <span><b> Erro - </b> N\u00e3o foi poss\u00edvel enviar os dados!</span> </div>')}).always(function(a){b.removeAttr("disabled")})},addToHierarchy:function(a,c,b){var e=c.find("fieldset").not(c.find("fieldset fieldset"));c=c.find("input, select, textarea").not(c.find("fieldset *")).filter(":visible");var d={};c.each(function(){var a=$(this);d[a.data("hsName")]=(a.val()||"").trim()});c.length&&(b?a.push(d):$.extend(a,d));e.each(function(){var b=
$(this).data("hsName");a[b]=a[b]||[];_Template.addToHierarchy(a[b],$(this),!0)})},QS:function(a){return(location.search||"").split(a+"=").pop().split("&").shift()}};$(_Template.init);